---
import { UiNavbar } from "../components/navbar/ui-navbar";
import { UiNavbarBrand } from "../components/navbar/ui-navbar-brand";
import { UiNavbarContent } from "../components/navbar/ui-navbar-content";
import { ClientRouter } from "astro:transitions";
import { sidebarConfig } from "../config/navigation";
import {
UiSidebar,
UiSidebarContent,
UiSidebarFooter,
UiSidebarGroup,
UiSidebarGroupLabel,
UiSidebarHeader,
UiSidebarMenu,
UiSidebarMenuButton,
UiSidebarMenuItem,
UiSidebarTrigger
} from "../components/sidebar";
import "../globals.css";

interface Props {
  title: string;
  showSidebar?: boolean;
}

const { title, showSidebar = false } = Astro.props;
const currentPath = Astro.url.pathname;

const isActive = (path: string) => currentPath === path || currentPath.startsWith(path + "/");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <ClientRouter />
  </head>
  <body class="bg-background text-foreground font-sans min-h-screen flex flex-col overflow-x-hidden">
    <UiNavbar client:only="lit">
      <UiNavbarBrand client:only="lit" href="/">Lit Components</UiNavbarBrand>
      <UiNavbarContent client:only="lit">
        <a
          href="/"
          class={`text-base font-medium transition-colors hover:text-primary ${
            currentPath === "/" ? "text-primary border-b-2 border-primary" : "text-muted-foreground"
          }`}
        >
          Home
        </a>
        <a
          href="/icons"
          class={`text-base font-medium transition-colors hover:text-primary ${
            isActive("/icons") ? "text-primary border-b-2 border-primary" : "text-muted-foreground"
          }`}
        >
          Icons
        </a>
        <a
          href="/components/buttons"
          class={`text-base font-medium transition-colors hover:text-primary ${
            isActive("/components") ? "text-primary border-b-2 border-primary" : "text-muted-foreground"
          }`}
        >
          Components
        </a>
      </UiNavbarContent>
    </UiNavbar>

    <div class="flex flex-1 overflow-hidden">
      {
        showSidebar && (
          <UiSidebar client:only="lit" class="hidden md:block border-r bg-card h-full overflow-y-auto">
             <UiSidebarHeader client:only="lit" class="flex h-16 items-center px-4 border-b border-border justify-between">
                <span class="font-bold">Components</span>
                <UiSidebarTrigger client:only="lit" />
             </UiSidebarHeader>
            <UiSidebarContent client:only="lit">
              <UiSidebarMenu client:only="lit">
                <UiSidebarGroup client:only="lit">
                  <UiSidebarGroupLabel client:only="lit">Library</UiSidebarGroupLabel>
                  {sidebarConfig.items.map((item) => (
                      <UiSidebarMenuItem client:only="lit">
                        <UiSidebarMenuButton client:only="lit" href={item.href} isActive={isActive(item.href)} icon={item.icon}>
                          {item.label}
                        </UiSidebarMenuButton>
                      </UiSidebarMenuItem>
                    ))}
                </UiSidebarGroup>
              </UiSidebarMenu>
            </UiSidebarContent>
            <UiSidebarFooter client:only="lit" class="p-4 border-t">
              <div class="text-xs text-muted-foreground truncate">v0.1.0</div>
            </UiSidebarFooter>
          </UiSidebar>
        )
      }

      <main class="flex-1 w-full overflow-auto p-4 md:p-8 relative">
        <div class="container mx-auto max-w-7xl">
          <slot />
        </div>
      </main>
    </div>
  </body>
</html>
